<!DOCTYPE html>
<html>
<head>
    <title>Touché-coulé</title>
    <style>
        table { border-collapse: collapse; margin: 10px 0; }
        td { width: 30px; height: 30px; border: 1px solid black; text-align: center; cursor: pointer; }
        td.hit { background-color: darkred; }
        td.miss { background-color: #87cefa; }
        h1 { color: #333; }
        #message { font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>
<h1>Touché-coulé</h1>
<table id="grid"></table>
<p id="message"></p>

<script>
const GRID_SIZE = 10;
let grid = [];

// Initialisation de la grille
for (let i = 0; i < GRID_SIZE; i++) {
    grid[i] = [];
    for (let j = 0; j < GRID_SIZE; j++) grid[i][j] = 0;
}

// Placement sécurisé des bateaux
function placeShip(x, y, length, direction) {
    if (direction === "H") {
        if (y + length > GRID_SIZE) return false;
        for (let i = 0; i < length; i++) if (grid[x][y+i] === 1) return false;
        for (let i = 0; i < length; i++) grid[x][y+i] = 1;
    } else {
        if (x + length > GRID_SIZE) return false;
        for (let i = 0; i < length; i++) if (grid[x+i][y] === 1) return false;
        for (let i = 0; i < length; i++) grid[x+i][y] = 1;
    }
    return true;
}

// Placer quelques bateaux
placeShip(1,1,4,"H");
placeShip(3,5,3,"V");

const table = document.getElementById("grid");
for (let i = 0; i < GRID_SIZE; i++) {
    const row = document.createElement("tr");
    for (let j = 0; j < GRID_SIZE; j++) {
        const cell = document.createElement("td");
        cell.dataset.x = i;
        cell.dataset.y = j;
        cell.addEventListener("click", () => fire(i,j,cell));
        row.appendChild(cell);
    }
    table.appendChild(row);
}

// Fonction pour vérifier si tous les bateaux sont coulés
function checkWin() {
    for (let i = 0; i < GRID_SIZE; i++) {
        for (let j = 0; j < GRID_SIZE; j++) {
            if (grid[i][j] === 1) return false;
        }
    }
    return true;
}

// Fonction tir
function fire(x,y,cell) {
    const message = document.getElementById("message");
    if (grid[x][y] === 2 || grid[x][y] === 3) {
        message.textContent = "Vous avez déjà tiré ici !";
        return;
    }
    if (grid[x][y] === 1) {
        grid[x][y] = 2;
        cell.classList.add("hit");
        message.textContent = "Touché !";
    } else {
        grid[x][y] = 3;
        cell.classList.add("miss");
        message.textContent = "Manqué !";
    }

    if (checkWin()) {
        message.textContent = "Félicitations ! Vous avez coulé tous les bateaux !";
    }
}
</script>
</body>
</html>
